<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" type="text/css" href="style.css" />
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous"/>
	<script src="https://apis.google.com/js/platform.js" async defer></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="scripts.js"></script>
	<script src="signup_scripts.js"></script>
	<link rel="stylesheet" type="text/css" href="signup_style.css" />
	<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
	<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

<meta charset="ISO-8859-1">
<title>Insert title here</title>
</head>

<script>
function verify() {
	var username = document.getElementById('username').value;
	var password = document.getElementById('password').value;
	var rememberMe = $('input[type=checkbox]').prop('checked');
	
	const Url = 'http://localhost:9000/user/login';
	
	var toTransfer = 
		{
			'username' : username,
			'password' : password
		}

	$.ajax({
		url: Url,
		type: 'POST',
		contentType:'application/json',

		data: JSON.stringify(toTransfer),
		success: function(result) {	
			
			if (rememberMe == true) {
				var date = new Date();
				date.setTime(date.getTime()+ 6*60*60*1000);
				
				document.cookie = 'login_cookie='+result+';expires='+date.toGMTString()+';path=/';
			}
			else {
				document.cookie = 'login_cookie='+result+';path=/';
			}

			// INSERT LOGIC TO RETURN TO BROWSE PAGE
			// temporary logic
			window.location.href = '/browse/browse.html';
		},
		error: function(error){
			var responseText = error['responseText'];

			if (responseText == 'USER DOES NOT EXIST') {
				// INSERT LOGIC IF USER DOES NOT EXIST
				// TEMPORARY LOGIC
				alert("user does not exist");
			}
			
			else if (responseText == 'INCORRECT PASSWORD') {
				// INSERT LOGIC IF PASSWORD IS WRONG
				// Temporary logic
				alert("incorrect password");
			}
		}
	})
	
	
}

</script>


<body>
	<div id="main-container">
		<div id="header">Login</div>
		<img src=./icon.png id="icon">
		<form name="login" id="login">
			<div id="usernameContainer">
				<input type="text" name="username" id="username"
					placeholder="username">
			</div>
			<div id="usernameError">Invalid username</div>
			<div id="passwordContainer">
				<input type="password" name="password" id="password"
					placeholder="password">
			</div>
			<label> <input type="checkbox" name="remember" id="remember">
				Remember me
			</label>
		</form>
		<div id="buttons">
			<button id="next" onclick="verify()">Submit</button>
		</div>
	</div>

</body>
</html>